!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Linger=t():e.Linger=t()}(this,function(){return function(e){function t(i){if(r[i])return r[i].exports;var n=r[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,t),n.l=!0,n.exports}var r={};return t.m=e,t.c=r,t.d=function(e,r,i){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=10)}([function(e,t,r){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),a=r(2),o=function(){function e(t){i(this,e),Object.assign(this,{name:t,levels:["none","error","warn","log"],level:3})}return n(e,[{key:"mute",value:function(){this.setLevel("none")}},{key:"setLevel",value:function(e){if((0,a.stupidIsType)(e,String)||"string"==typeof e){var t=0;switch(e){case"none":t=0;break;case"error":t=1;break;case"warn":t=2;break;case"log":t=3}this.level=t}}},{key:"log",value:function(){if(this.level>=3){for(var e,t=arguments.length,r=Array(t),i=0;i<t;i++)r[i]=arguments[i];(e=console).log.apply(e,["[lig."+this.name+".log]: "].concat(r))}}},{key:"warn",value:function(){if(this.level>=2){for(var e,t=arguments.length,r=Array(t),i=0;i<t;i++)r[i]=arguments[i];(e=console).warn.apply(e,["[lig."+this.name+".warn]: "].concat(r))}}},{key:"error",value:function(){if(this.level>=1){for(var e,t=arguments.length,r=Array(t),i=0;i<t;i++)r[i]=arguments[i];(e=console).error.apply(e,["[lig."+this.name+".error]: "].concat(r))}}}]),e}(),c=function(){function e(){i(this,e)}return n(e,[{key:"createLogger",value:function(e){var t=new o(e);return this[e]=t,t}}]),e}(),s=new c;t.default=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(17);Object.defineProperty(t,"createMatrix3",{enumerable:!0,get:function(){return i.createMatrix3}}),Object.defineProperty(t,"createMatrix4",{enumerable:!0,get:function(){return i.createMatrix4}}),Object.defineProperty(t,"Matrix3",{enumerable:!0,get:function(){return i.Matrix3}}),Object.defineProperty(t,"Matrix4",{enumerable:!0,get:function(){return i.Matrix4}});var n=r(18);Object.defineProperty(t,"createVector3",{enumerable:!0,get:function(){return n.createVector3}}),Object.defineProperty(t,"createVector4",{enumerable:!0,get:function(){return n.createVector4}}),Object.defineProperty(t,"Vector3",{enumerable:!0,get:function(){return n.Vector3}}),Object.defineProperty(t,"Vector4",{enumerable:!0,get:function(){return n.Vector4}});var a=r(19);Object.defineProperty(t,"createQuaternion",{enumerable:!0,get:function(){return a.createQuaternion}}),Object.defineProperty(t,"Quaternion",{enumerable:!0,get:function(){return a.Quaternion}});var o=r(20);Object.defineProperty(t,"PI",{enumerable:!0,get:function(){return o.PI}}),Object.defineProperty(t,"angleToRadian",{enumerable:!0,get:function(){return o.angleToRadian}}),Object.defineProperty(t,"radianToAngle",{enumerable:!0,get:function(){return o.radianToAngle}})},function(e,t,r){"use strict";function i(e,t){for(var r,i=Object.getPrototypeOf(e),n=Object.getPrototypeOf(i),a=arguments.length,o=Array(a>2?a-2:0),c=2;c<a;c++)o[c-2]=arguments[c];(r=n[t]).call.apply(r,[e].concat(o))}function n(e,t){return null!=t&&(!!t.isPrototypeOf(e)||n(e,t.prototype))}Object.defineProperty(t,"__esModule",{value:!0}),t.callSuperiorProto=i,t.stupidIsType=n},function(e,t,r){"use strict";function i(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function n(e){var t=e.vertices,r=e.indices,i=Object.create(c);return i.init(t,r),i}Object.defineProperty(t,"__esModule",{value:!0}),t.SimpleMesh=t.createSimpleMesh=void 0;var a=r(0),o=function(e){return e&&e.__esModule?e:{default:e}}(a),c={static:{type:"SimpleMesh"},init:function(e,t,r){if(!Array.isArray(e)||!Array.isArray(t))return void o.default.prod.error("either vertices or indices is not an Array type");r||(r="TRIANGLES"),Object.assign(this,{_vertices:[].concat(i(e)),_indices:[].concat(i(t)),mode:r})},get vertices(){return this._vertices},get indices(){return this._indices}};t.createSimpleMesh=n,t.SimpleMesh=c},function(e,t,r){"use strict";function i(e){var t=Object.create(a);return t.init(e),t}Object.defineProperty(t,"__esModule",{value:!0}),t.Camera=t.createCamera=void 0;var n=r(1),a={static:{type:"Camera",makePerspectiveProjectionMatrix:function(e,t,r,i){var a=(0,n.angleToRadian)(.5*e),o=Math.tan(a),c=r,s=i,u=t/o,m=1/o,l=(c+s)/(s-c),f=2*s*c/(c-s);return(0,n.createMatrix4)(u,0,0,0,0,m,0,0,0,0,l,-1,0,0,f,0)}},init:function(e,t){t=Object.assign({vFOVAngle:45,hwAspect:e.height/e.width,nearClip:-1,farClip:-100,perspectiveProjectionMatrix:null},t),this._=t},get vFOVAngle(){return this._.vFOVAngle},get hwAspect(){return this._.hwAspect},get nearClip(){return this._.nearClip},get farClip(){return this._.farClip},get perspectiveProjectionMatrix(){return this._.perspectiveProjectionMatrix||(this._.perspectiveProjectionMatrix=this.static.makePerspectiveProjectionMatrix(this.vFOVAngle,this.hwAspect,this.nearClip,this.farClip)),this._.perspectiveProjectionMatrix}};t.createCamera=i,t.Camera=a},function(e,t,r){"use strict";function i(e){return!!c.BasicShader.static.init(e)||(l.default.prod.error("failed to call basic shader static init func"),!1)}function n(e){return!!o.BasicBatch.static.init(e)||(l.default.prod.error("failed to call basic batch static init func"),!1)}function a(e){var t=e.getContext("webgl2");if(!t)return l.default.prod.error("no webgl2 in the given canvas detected"),null;if(!i(t))return l.default.prod.error("failed to init BasicBatch environment"),null;if(!n(t))return l.default.prod.error("failed to init BasicBatch environment"),null;var r=(0,u.createGLib)(e,t);return r?(r.resize(),r):(l.default.prod.error("failed to create glib with the given canvas"),null)}Object.defineProperty(t,"__esModule",{value:!0}),t.CameraPrimitive=t.createCameraPrimitive=t.SimpleMeshPrimitive=t.createSimpleMeshPrimitive=t.initGraphicsEnvironment=void 0;var o=r(6),c=r(7),s=r(8),u=r(16),m=r(0),l=function(e){return e&&e.__esModule?e:{default:e}}(m);t.initGraphicsEnvironment=a,t.createSimpleMeshPrimitive=s.createSimpleMeshPrimitive,t.SimpleMeshPrimitive=s.SimpleMeshPrimitive,t.createCameraPrimitive=s.createCameraPrimitive,t.CameraPrimitive=s.CameraPrimitive},function(e,t,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t,r,i){var n=Object.create(f);return n.init(e,t,r,i),n}Object.defineProperty(t,"__esModule",{value:!0}),t.BasicBatch=t.createBasicBatch=void 0;var a=r(0),o=i(a),c=r(7),s=r(13),u=i(s),m=r(14),l=i(m),f={static:{init:function(e){return e?(Object.assign(f.static,{gl:e,attributes:{position:{name:"a_position",location:null,numComponent:3,componentType:e.FLOAT,normalized:!1,stride:0,offset:0,vbo:null,bufferDataType:Float32Array},baryCenter:{name:"a_baryCenter",location:null,numComponent:3,componentType:e.FLOAT,normalized:!1,stride:0,offset:0,vbo:null,bufferDataType:Float32Array}},uniforms:{transform:{name:"u_transform_mat4",location:null,data:null},view:{name:"u_view_mat4",location:null,data:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},perspectiveProjection:{name:"u_perspective_projection_mat4",location:null,data:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}}}),!0):(o.default.prod.error("no gl context provided"),!1)},_setUniformsForMatrix4fvToGL:function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];var n=!0,a=!1,o=void 0;try{for(var c,s=r[Symbol.iterator]();!(n=(c=s.next()).done);n=!0){var u=c.value;e.uniformMatrix4fv(u.location,!1,u.data.m)}}catch(e){a=!0,o=e}finally{try{!n&&s.return&&s.return()}finally{if(a)throw o}}},_uploadVBOWithArributeToGL:function(e,t,r){e.bindBuffer(e.ARRAY_BUFFER,t.vbo),e.bufferData(e.ARRAY_BUFFER,new t.bufferDataType(r),e.STATIC_DRAW),e.enableVertexAttribArray(t.location),e.vertexAttribPointer(t.location,t.numComponent,t.componentType,t.normalized,t.stride,t.offset)},updateUniformData:function(e){e.view&&(f.static.uniforms.view.data=e.view),e.perspectiveProjection&&(f.static.uniforms.perspectiveProjection.data=e.perspectiveProjection)}},init:function(e,t,r,i){var n=i.wireframeMode,a=this.static.gl;Object.assign(this,{key:e,vao:a.createVertexArray(),attributes:{position:Object.assign(Object.create(f.static.attributes.position),{vbo:a.createBuffer()}),baryCenter:Object.assign(Object.create(f.static.attributes.baryCenter),{vbo:a.createBuffer()})},uniforms:{transform:Object.assign(Object.create(f.static.uniforms.transform),{data:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]})},shader:null,data:{mode:"TRIANGLES",position:[],indices:[]},indices:{vbo:a.createBuffer(),bufferDataType:Uint16Array}});var o=c.BasicShader.static.getShader("default");return n&&((o=c.BasicShader.static.getShader("wireframeShader"))||(o=c.BasicShader.static.addShaderProgram("wireframeShader",(0,c.createBasicShader)(a,[{type:a.VERTEX_SHADER,source:u.default,fileName:"vert.wireframe.glsl"},{type:a.FRAGMENT_SHADER,source:l.default,fileName:"frag.wireframe.glsl"}])))),this.useShader(o),t&&this.updateVertexData(t),r&&this.updateUniformData(r),!0},_setVertextAttributeLocation:function(e,t,r){var i=e.getAttribLocation(t.program,r.name);return null==i?(o.default.prod.error("no attribute for '"+r.name+"' location found"),!1):(r.location=i,!0)},_setUniform:function(e,t,r){var i=e.getUniformLocation(t.program,r.name);return i?(r.location=i,!0):(o.default.prod.error("no uniform for '"+r.name+"' location found"),!1)},useShader:function(e){var t=this.static.gl;return e?(this.shader=e,!(!this._setVertextAttributeLocation(t,e,this.static.attributes.position)||!this._setVertextAttributeLocation(t,e,this.static.attributes.baryCenter))&&!!(this._setUniform(t,e,this.static.uniforms.transform)&&this._setUniform(t,e,this.static.uniforms.view)&&this._setUniform(t,e,this.static.uniforms.perspectiveProjection))):(o.default.prod.error("no shader can be used."),!1)},updateVertexData:function(e){var t=this.static.gl;if(e){if(!e.positions||!e.indices)return o.default.prod.error(" call fillVertPositionData() failed, data is not valid"),!1;Object.assign(this.data,e)}else e=this.data;return t.bindVertexArray(this.vao),e.positions&&f.static._uploadVBOWithArributeToGL(t,this.attributes.position,e.positions),e.baryCenters&&f.static._uploadVBOWithArributeToGL(t,this.attributes.baryCenter,e.baryCenters),e.indices&&(t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indices.vbo),t.bufferData(t.ELEMENT_ARRAY_BUFFER,new this.indices.bufferDataType(e.indices),t.STATIC_DRAW)),t.bindVertexArray(null),!0},updateUniformData:function(e){e.transform&&(this.uniforms.transform.data=e.transform)},draw:function(){var e=this.static.gl;switch(e.useProgram(this.shader.program),e.bindVertexArray(this.vao),f.static._setUniformsForMatrix4fvToGL(e,this.uniforms.transform,f.static.uniforms.view,f.static.uniforms.perspectiveProjection),this.data.mode){case"TRIANGLES":case"TRIANGLE_STRIP":e.drawElements(e[this.data.mode],this.data.indices.length,e.UNSIGNED_SHORT,0);break;default:o.default.prod.error("abort to call gl.drawElements. the given primitive mode "+this.data.mode+" not supported. ")}}};t.createBasicBatch=n,t.BasicBatch=f},function(e,t,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){var r=Object.create(l);return r.init(e,t),r}Object.defineProperty(t,"__esModule",{value:!0}),t.BasicShader=t.createBasicShader=void 0;var a=r(0),o=i(a),c=r(11),s=i(c),u=r(12),m=i(u),l={static:{init:function(e){var t=n(e,[{type:e.VERTEX_SHADER,source:s.default,fileName:"vert.glsl"},{type:e.FRAGMENT_SHADER,source:m.default,fileName:"frag.glsl"}]);return l.static._={gl:e,shaders:{default:t}},!0},getShader:function(e){return l.static._.shaders[e]},addShaderProgram:function(e,t){var r=l.static._.shaders;return r[e]||(r[e]=t),r[e]}},init:function(e,t){var r=this;if(!e||!t||!t.length)return void o.default.prod.error("creating BasicShader failed. parameters needs to be fed correctly");Object.assign(this,{gl:e,configs:t,shaders:[],program:null});var i=t.map(function(t){var i=t.type,n=t.source,a=t.fileName;return r._createShader(e,i,n,a)}),n=this._createProgram(e,i);i&&n&&(this.shaders=i,this.program=n)},_createShader:function(e,t,r,i){var n=e.createShader(t);return e.shaderSource(n,r),e.compileShader(n),e.getShaderParameter(n,e.COMPILE_STATUS)?n:(o.default.prod.error("can not compile shader "+i),e.deleteShader(n),null)},_createProgram:function(e,t,r){var i=e.createProgram();return t.map(function(t){e.attachShader(i,t)}),e.linkProgram(i),e.getProgramParameter(i,e.LINK_STATUS)?i:(o.default.prod.error("can not link shader program for",r.map(function(e){return e.fileName})),e.deleteProgram(i),null)}};t.createBasicShader=n,t.BasicShader=l},function(e,t,r){"use strict";function i(e,t,r){var i=t.vertPosition,n=t.vertIndices,a=t.transformMat4,u=t.mode;if(r.wireframeMode){var m=(0,o.createWireframeData)(i,n,u),l=m.vertPosition,f=m.vertIndices,d=m.vertBaryCenter,_=m.mode,v=Object.create(s);return v.init(e,{vertPosition:l,vertIndices:f,mode:_,transformMat4:a,vertBaryCenter:d}),v}var h=Object.create(c);return h.init(e,{vertPosition:i,vertIndices:n,transformMat4:a}),h}function n(e,t,r){var i=Object.create(u);return i.init(e,t,r),i}Object.defineProperty(t,"__esModule",{value:!0}),t.CameraPrimitive=t.SimpleMeshWireframePrimitive=t.SimpleMeshPrimitive=t.createCameraPrimitive=t.createSimpleMeshPrimitive=void 0;var a=r(2),o=r(15),c={init:function(e,t){var r=t.vertPosition,i=t.vertIndices,n=t.transformMat4,a=t.mode;Object.assign(this,{key:e,vertPosition:r,vertIndices:i,transformMat4:n,mode:a||"TRIANGLES"})}},s=Object.create(c);Object.assign(s,{init:function(e,t){var r=t.vertPosition,i=t.vertIndices,n=t.transformMat4,o=t.vertBaryCenter,c=t.mode;(0,a.callSuperiorProto)(this,"init",e,{vertPosition:r,vertIndices:i,transformMat4:n,mode:c}),Object.assign(this,{vertBaryCenter:o})}});var u={init:function(e,t,r){Object.assign(this,{key:e,viewMatrix:t,perspectiveProjectionMatrix:r})}};t.createSimpleMeshPrimitive=i,t.createCameraPrimitive=n,t.SimpleMeshPrimitive=c,t.SimpleMeshWireframePrimitive=s,t.CameraPrimitive=u},function(e,t,r){"use strict";function i(e){var t=Object.create(l);return t.init(e),t}Object.defineProperty(t,"__esModule",{value:!0}),t.SceneNode=t.createSceneNode=void 0;var n=r(1),a=r(5),o=r(2),c=r(0),s=function(e){return e&&e.__esModule?e:{default:e}}(c),u=r(3),m=r(4),l={static:{_cur_max_id:-1,_glib:null,_assignNewID:function(){return++l.static._cur_max_id},init:function(e){return l.static._glib=e,!0}},init:function(e){e=Object.assign({active:null==e.active||e.active,position:e.position||[0,0,0],rotation:e.rotation,rotationAxisAngle:e.rotationAxisAngle,scale:e.scale||[1,1,1],name:e.name||"defaultSceneNodeName",mounted:e.mounted||{type:"Void",data:null},id:this.static._assignNewID(),nodeIsDirty:!0,children:[],parent:null}),Object.assign(this,e),this.setPosition(e.position),e.rotation?this.setRotation(e.rotation):e.rotationAxisAngle?this.setRotationAxisAngle(e.rotationAxisAngle):this.setRotation(0,0,0,1),this.setScale(e.scale)},setPosition:function(e,t,r){var i=e;return(0,o.stupidIsType)(i,n.Vector3)||(i=(0,n.createVector3)(e,t,r)),this.position=i,this.dirtyTransform=!0,this},getPosition:function(){return this.position.copy()},translate:function(e,t,r){var i=e;return(0,o.stupidIsType)(i,n.Vector3)||(i=(0,n.createVector3)(e,t,r)),this.position.add(i),this.dirtyTransform=!0,this},setRotation:function(e,t,r,i){var a=e;return(0,o.stupidIsType)(a,n.Quaternion)||(a=(0,n.createQuaternion)(e,t,r,i)),this.rotation=a,this.dirtyTransform=!0,this},getRotation:function(){return this.rotation.copy()},rotate:function(e,t,r,i){var a=e;return(0,o.stupidIsType)(a,n.Quaternion)||(a=(0,n.createQuaternion)(e,t,r,i)),this.rotation=n.Quaternion.static.multiply(a,this.rotation),this.dirtyTransform=!0,this},setRotationAxisAngle:function(e,t,r,i){var a=n.Quaternion.static.createFromAxisAngle(e,t,r,i);return this.rotation=a,this.dirtyTransform=!0,this},getRotationAxisAngle:function(){},rotateAxisAngle:function(e,t,r,i){var a=n.Quaternion.static.createFromAxisAngle(e,t,r,i);this.rotation=n.Quaternion.static.multiply(a,this.rotation)},setScale:function(e,t,r){var i=e;return(0,o.stupidIsType)(i,n.Vector3)||(i=(0,n.createVector3)(e,t,r)),this.scale=i,this.dirtyTransform=!0,this},getScale:function(){return this.scale.copy()},scale:function(e,t,r){var i=e;return(0,o.stupidIsType)(i,n.Vector3)||(i=(0,n.createVector3)(e,t,r)),this.scale=(0,n.createVector3)(this.scale.x*i.x,this.scale.y*i.y,this.scale.z*i.z),this.dirtyTransform=!0,this},getParent:function(){return this.parent},addSceneNode:function(e){e.parent=this,this.children.push(e)},mount:function(e,t){if(0==[u.SimpleMesh.static.type].includes(e))return void s.default.prod.error("the mounting type is not supported for now");this.mounted={type:e,data:t}},_processDirtyList:function(e,t){var r=[],i=null,n=null,o=!0,c=!1,l=void 0;try{for(var f,d=e[Symbol.iterator]();!(o=(f=d.next()).done);o=!0){var _=f.value,v=_.node,h=v.mounted,p=_.transformMat4;if(v.active)switch(h.type){case u.SimpleMesh.static.type:var y=(0,a.createSimpleMeshPrimitive)(v.id,{vertPosition:h.data.vertices,vertIndices:h.data.indices,transformMat4:p,mode:h.data.mode},t);r.push(y);break;case m.Camera.static.type:i=h.data,n=p}}}catch(e){c=!0,l=e}finally{try{!o&&d.return&&d.return()}finally{if(c)throw l}}if(!i)return void s.default.prod.error("none camera exists or activated. at least one camera should be added into the scene and keep active.");var b=(0,a.createCameraPrimitive)("camera-prim",n,i.perspectiveProjectionMatrix);return r.push(b),r},_updateRecursive:function(e,t,r){var i=n.Matrix4.static.transform(e.position,e.rotation,e.scale),a=n.Matrix4.static.multiply(i,t);if(e.children.length>0){var o=!0,c=!1,s=void 0;try{for(var u,m=e.children[Symbol.iterator]();!(o=(u=m.next()).done);o=!0){var l=u.value;l.nodeIsDirty&&(l._updateRecursive(l,a,r),l.nodeIsDirty=!1)}}catch(e){c=!0,s=e}finally{try{!o&&m.return&&m.return()}finally{if(c)throw s}}}r.push({node:e,transformMat4:a})},update:function(e){if(this.nodeIsDirty){this.nodeIsDirty=!1;var t=(0,n.createMatrix4)(),r=[];this._updateRecursive(this,t,r);var i=this._processDirtyList(r,e);this.static._glib.syncAndRender(i,e)}}};t.createSceneNode=i,t.SceneNode=l},function(e,t,r){"use strict";function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),a=function(e){return e&&e.__esModule?e:{default:e}}(n),o=r(5),c=i(o),s=r(21),u=i(s),m=r(1),l=i(m);a.default.createLogger("debug"),a.default.createLogger("prod");var f=Object.assign({},u,l),d=Object.create(f);Object.assign(d,{logger:a.default,init:function(e){var t=c.initGraphicsEnvironment(e);return!!t&&!!u.initSceneAndNodeEnvironment(t)}}),t.default=d,e.exports=d},function(e,t){e.exports="#version 300 es\n\n// an attribute is an input (in) to a vertex shader.\n// It will receive data from a buffer\nin vec4 a_position;\nin vec4 a_baryCenter;\n\n// LINOTE: uniforms can't be just declared without use below. in which condition\n// it seems will be removed due to optimization\n// uniform vec4 u_translate;\nuniform mat4 u_transform_mat4;\nuniform mat4 u_view_mat4;\nuniform mat4 u_perspective_projection_mat4;\n\n// all shaders have a main function\nvoid main() {\n  gl_Position = u_perspective_projection_mat4 * inverse(u_view_mat4) * u_transform_mat4 * a_position;\n}\n"},function(e,t){e.exports='#version 300 es\n\n// fragment shaders don\'t have a default precision so we need\n// to pick one. mediump is a good default. It means "medium precision"\nprecision mediump float;\n\n// we need to declare an output for the fragment shader\nout vec4 outColor;\n\nvoid main() {\n  // Just set the output to a constant redish-purple\n  outColor = vec4(1, 0, 0.5, 1);\n}\n'},function(e,t){e.exports="#version 300 es\n\n// an attribute is an input (in) to a vertex shader.\n// It will receive data from a buffer\nin vec4 a_position;\nin vec3 a_baryCenter;\nout vec3 v_baryCenter;\n\n// LINOTE: uniforms can't be just declared without use below. in which condition\n// it seems will be removed due to optimization\n// uniform vec4 u_translate;\nuniform mat4 u_transform_mat4;\nuniform mat4 u_view_mat4;\nuniform mat4 u_perspective_projection_mat4;\n\n// all shaders have a main function\nvoid main() {\n    v_baryCenter = a_baryCenter;\n    gl_Position = u_perspective_projection_mat4 * inverse(u_view_mat4) * u_transform_mat4 * a_position;\n}\n"},function(e,t){e.exports='#version 300 es\n\n// fragment shaders don\'t have a default precision so we need\n// to pick one. mediump is a good default. It means "medium precision"\nprecision mediump float;\n\nin vec3 v_baryCenter;\n\n// we need to declare an output for the fragment shader\nout vec4 outColor;\n\nvoid main() {\n  // Just set the output to a constant redish-purple\n  if(any(lessThan(v_baryCenter, vec3(0.003)))){\n      outColor = vec4(1, 0, 0.5, 1);\n  } else {\n      outColor = vec4(0, 0, 0, 0.5);\n  }\n}\n'},function(e,t,r){"use strict";function i(e,t,r){var i=[],n=[],a=[];if("TRIANGLES"==r){var o=!0,c=!1,s=void 0;try{for(var u,m=t.keys()[Symbol.iterator]();!(o=(u=m.next()).done);o=!0){var l=u.value;n.push(l);var f=3*t[l];switch(i.push(e[f],e[f+1],e[f+2]),l%3){case 0:a.push(1,0,0);break;case 1:a.push(0,1,0);break;case 2:a.push(0,0,1)}}}catch(e){c=!0,s=e}finally{try{!o&&m.return&&m.return()}finally{if(c)throw s}}}return{vertPosition:i,vertIndices:n,vertBaryCenter:a,mode:"TRIANGLES"}}Object.defineProperty(t,"__esModule",{value:!0}),t.createWireframeData=i},function(e,t,r){"use strict";function i(e,t){var r=Object.create(u);return r.init(e,t),r}Object.defineProperty(t,"__esModule",{value:!0}),t.createGLib=void 0;var n=r(0),a=function(e){return e&&e.__esModule?e:{default:e}}(n),o=r(1),c=r(6),s=r(8),u={init:function(e,t){return e?t?(Object.assign(this,{canvas:e,gl:t,batches:{basic:[]},viewMat4:(0,o.createMatrix4)(),perspectiveProjectionMat4:(0,o.createMatrix4)()}),!0):(a.default.prod.error("sorry. no gl detected"),!1):(a.default.prod.error("sorry. no canvas detected"),!1)},_createBasicBatchWithPrimitive:function(e,t){var r={positions:e.vertPosition,indices:e.vertIndices,baryCenters:e.vertBaryCenter,mode:e.mode},i={transform:e.transformMat4};return(0,c.createBasicBatch)(e.key,r,i,t)},resize:function(){var e=window.devicePixelRatio||1,t=Math.floor(this.gl.canvas.clientWidth*e),r=Math.floor(this.gl.canvas.clientHeight*e);this.gl.canvas.width!=t&&(this.gl.canvas.width=t),this.gl.canvas.height!=r&&(this.gl.canvas.height=r)},sync:function(e,t){var r=!0,i=!1,n=void 0;try{for(var a,o=e[Symbol.iterator]();!(r=(a=o.next()).done);r=!0){var u=a.value;switch(Object.getPrototypeOf(u)){case s.SimpleMeshPrimitive:case s.SimpleMeshWireframePrimitive:var m=this._createBasicBatchWithPrimitive(u,t);this.batches.basic.push(m);break;case s.CameraPrimitive:c.BasicBatch.static.updateUniformData({view:u.viewMatrix,perspectiveProjection:u.perspectiveProjectionMatrix})}}}catch(e){i=!0,n=e}finally{try{!r&&o.return&&o.return()}finally{if(i)throw n}}},render:function(){this.resize();var e=this.gl;e.viewport(0,0,e.drawingBufferWidth,e.drawingBufferHeight),e.clearColor(0,0,0,1),e.clear(e.COLOR_BUFFER_BIT);var t=!0,r=!1,i=void 0;try{for(var n,a=this.batches.basic[Symbol.iterator]();!(t=(n=a.next()).done);t=!0){n.value.draw()}}catch(e){r=!0,i=e}finally{try{!t&&a.return&&a.return()}finally{if(r)throw i}}},syncAndRender:function(e,t){this.sync(e,t),this.render()}};t.createGLib=i},function(e,t,r){"use strict";function i(e){var t,r=null;switch(e){case 3:r=Object.create(o);break;case 4:r=Object.create(c)}for(var i=arguments.length,n=Array(i>1?i-1:0),a=1;a<i;a++)n[a-1]=arguments[a];return(t=r).init.apply(t,n),r}function n(e,t,r,n,a,o,c,s,u){return i(3,e,t,r,n,a,o,c,s,u)}function a(e,t,r,n,a,o,c,s,u,m,l,f,d,_,v,h){return i(4,e,t,r,n,a,o,c,s,u,m,l,f,d,_,v,h)}Object.defineProperty(t,"__esModule",{value:!0}),t.createMatrix4=t.createMatrix3=t.Matrix4=t.Matrix3=void 0;var o=(r(1),{static:{multiply:function(e,t){var r=n();return r._m[0]=e._m[0]*t._m[0]+e._m[1]*t._m[3]+e._m[2]*t._m[6],r._m[1]=e._m[0]*t._m[1]+e._m[1]*t._m[4]+e._m[2]*t._m[7],r._m[2]=e._m[0]*t._m[2]+e._m[1]*t._m[5]+e._m[2]*t._m[8],r._m[3]=e._m[3]*t._m[0]+e._m[4]*t._m[3]+e._m[5]*t._m[6],r._m[4]=e._m[3]*t._m[1]+e._m[4]*t._m[4]+e._m[5]*t._m[7],r._m[5]=e._m[3]*t._m[2]+e._m[4]*t._m[5]+e._m[5]*t._m[8],r._m[6]=e._m[6]*t._m[0]+e._m[7]*t._m[3]+e._m[8]*t._m[6],r._m[7]=e._m[6]*t._m[1]+e._m[7]*t._m[4]+e._m[8]*t._m[7],r._m[8]=e._m[6]*t._m[2]+e._m[7]*t._m[5]+e._m[8]*t._m[8],r},transpose:function(e){var t=n();return t._m[0]=e._m[0],t._m[1]=e._m[3],t._m[2]=e._m[6],t._m[3]=e._m[1],t._m[4]=e._m[4],t._m[5]=e._[7],t._m[6]=e._m[2],t._m[7]=e._m[5],t._m[8]=e._m[8],t},transform:function(e,t,r){var i=e.v;return n(1,0,0,0,1,0,i[0],i[1],i[2])}},init:function(e,t,r,i,n,a,o,c,s){null!=e?Object.assign(this,{_m:[e,t,r,i,n,a,o,c,s]}):this.setIdentity()},get m(){return this._m},setIdentity:function(){this._m=[1,0,0,0,1,0,0,0,1]},multiply:function(e){var t=this.static.multiply(this,e);return this._m=t._m,this},transpose:function(){var e=this.static.transpose(this);return this._m=e._m,this},clone:function(){return n(this._m)}}),c={static:{multiply:function(e,t){var r=a();return r._m[0]=e._m[0]*t._m[0]+e._m[1]*t._m[4]+e._m[2]*t._m[8]+e._m[3]*t._m[12],r._m[1]=e._m[0]*t._m[1]+e._m[1]*t._m[5]+e._m[2]*t._m[9]+e._m[3]*t._m[13],r._m[2]=e._m[0]*t._m[2]+e._m[1]*t._m[6]+e._m[2]*t._m[10]+e._m[3]*t._m[14],r._m[3]=e._m[0]*t._m[3]+e._m[1]*t._m[7]+e._m[2]*t._m[11]+e._m[3]*t._m[15],r._m[4]=e._m[4]*t._m[0]+e._m[5]*t._m[4]+e._m[6]*t._m[8]+e._m[7]*t._m[12],r._m[5]=e._m[4]*t._m[1]+e._m[5]*t._m[5]+e._m[6]*t._m[9]+e._m[7]*t._m[13],r._m[6]=e._m[4]*t._m[2]+e._m[5]*t._m[6]+e._m[6]*t._m[10]+e._m[7]*t._m[14],r._m[7]=e._m[4]*t._m[3]+e._m[5]*t._m[7]+e._m[6]*t._m[11]+e._m[7]*t._m[15],r._m[8]=e._m[8]*t._m[0]+e._m[9]*t._m[4]+e._m[10]*t._m[8]+e._m[11]*t._m[12],r._m[9]=e._m[8]*t._m[1]+e._m[9]*t._m[5]+e._m[10]*t._m[9]+e._m[11]*t._m[13],r._m[10]=e._m[8]*t._m[2]+e._m[9]*t._m[6]+e._m[10]*t._m[10]+e._m[11]*t._m[14],r._m[11]=e._m[8]*t._m[3]+e._m[9]*t._m[7]+e._m[10]*t._m[11]+e._m[11]*t._m[15],r._m[12]=e._m[12]*t._m[0]+e._m[13]*t._m[4]+e._m[14]*t._m[8]+e._m[15]*t._m[12],r._m[13]=e._m[12]*t._m[1]+e._m[13]*t._m[5]+e._m[14]*t._m[9]+e._m[15]*t._m[13],r._m[14]=e._m[12]*t._m[2]+e._m[13]*t._m[6]+e._m[14]*t._m[10]+e._m[15]*t._m[14],r._m[15]=e._m[12]*t._m[3]+e._m[13]*t._m[7]+e._m[14]*t._m[11]+e._m[15]*t._m[15],r},transpose:function(e){var t=a();return t._m[0]=e._m[0],t._m[1]=e._m[4],t._m[2]=e._m[8],t._m[3]=e._m[12],t._m[4]=e._m[1],t._m[5]=e._m[5],t._m[6]=e._m[9],t._m[7]=e._m[13],t._m[8]=e._m[2],t._m[9]=e._m[6],t._m[10]=e._m[10],t._m[11]=e._m[14],t._m[12]=e._m[3],t._m[13]=e._m[7],t._m[14]=e._m[11],t._m[15]=e._m[15],t},translate:function(e){return a(1,0,0,0,0,1,0,0,0,0,1,0,e.v[0],e.v[1],e.v[2],1)},rotate:function(e){e.isNorm()||e.normalize();var t=e.y*e.y,r=e.z*e.z,i=e.x*e.y,n=e.w*e.z,o=e.x*e.z,c=e.w*e.y,s=e.x*e.x,u=e.y*e.z,m=e.w*e.x;return a(1-2*(t+r),2*(i+n),2*(o-c),0,2*(i-n),1-2*(s+r),2*(u+m),0,2*(o+c),2*(u-m),1-2*(s+t),0,0,0,0,1)},scale:function(e){return a(e.v[0],0,0,0,0,e.v[1],0,0,0,0,e.v[2],0,0,0,0,1)},transform:function(e,t,r){var i=c.static.scale(r),n=c.static.rotate(t),o=c.static.translate(e),s=a();return s.multiply(i).multiply(n).multiply(o),s}},init:function(e,t,r,i,n,a,o,c,s,u,m,l,f,d,_,v){null!=e?Object.assign(this,{_m:[e,t,r,i,n,a,o,c,s,u,m,l,f,d,_,v]}):this.setIdentity()},get m(){return this._m},setIdentity:function(){this._m=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},multiply:function(e){var t=this.static.multiply(this,e);return this._m=t._m,this},transpose:function(){var e=this.static.transpose(this);return this._m=e._m,this},translate:function(e){var t=this.static.translate(e);return this.multiply(t),this},clone:function(){return a(this._m)}};t.Matrix3=o,t.Matrix4=c,t.createMatrix3=n,t.createMatrix4=a},function(e,t,r){"use strict";function i(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function n(e){var t,r=null;switch(e){case 3:r=Object.create(s);break;case 4:r=Object.create(u)}for(var i=arguments.length,n=Array(i>1?i-1:0),a=1;a<i;a++)n[a-1]=arguments[a];return(t=r).init.apply(t,n),r}function a(e,t,r){return n(3,e,t,r)}function o(e,t,r,i){return n(4,e,t,r,i)}Object.defineProperty(t,"__esModule",{value:!0}),t.createVector4=t.createVector3=t.Vector4=t.Vector3=void 0;var c=r(2),s={static:{add:function(e,t){var r=a();return r._v[0]=e._v[0]+t._v[0],r._v[1]=e._v[1]+t._v[1],r._v[2]=e._v[2]+t._v[2],r},sub:function(e,t){var r=[].concat(i(t)).map(function(e){return-e});return this.static.add(e,r)},dot:function(e,t){return e._v[0]*t._v[0]+e._v[1]*t._v[1]+e._v[2]*t._v[2]},cross:function(e,t){return a(e.y*t.z-e.z*t.y,e.z*t.x-e.x*t.z,e.x*t.y-e.y*t.x)},scale:function(e,t){return a(e._v[0]*t,e._v[1]*t,e._v[2]*t)},multiplyMatrix3:function(e,t){}},init:function(e,t,r){var n=[0,0,0];if(null!=e)if((0,c.stupidIsType)(e,Array)){var a=e;n=[].concat(i(a))}else if((0,c.stupidIsType)(e,Object)){var o=e;n=[o.x,o.y,o.z,o.w]}else n=[e,t,r];this._v=n},get x(){return this._v[0]},get y(){return this._v[1]},get z(){return this._v[2]},get v(){return[].concat(i(this._v))},set v(e){this._v=[].concat(i(e))},add:function(e){var t=this.static.add(this,e);return this._v=t._v,this},sub:function(e){var t=this.static.sub(this,e,this);return this._v=t._v,this},dot:function(e){return this.static.dot(this,e)},cross:function(e){var t=this.static.cross(this,e);return this._v=t._v,this},scale:function(e){var t=this.static.scale(this,e);return this._v=t._v,this},clone:function(){return a(this._v)}},u={init:function(e,t,r,i){Object.assign(this,{_v:[0,0,0,1]})}};t.Vector3=s,t.Vector4=u,t.createVector3=a,t.createVector4=o},function(e,t,r){"use strict";function i(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function n(e,t,r,i){var n=Object.create(s);return n.init(e,t,r,i),n}function a(e,t,r,i){return s.static.createFromAxisAngle(e,t,r,i)}Object.defineProperty(t,"__esModule",{value:!0}),t.createQuaternionFromAxisAngle=t.createQuaternion=t.Quaternion=void 0;var o=r(1),c=r(2),s={static:{createFromAxisAngle:function(e,t,r,i){var a=[e,t,r];if((0,c.stupidIsType)(e,Array)){var s=e;a=[s[0],s[1],s[2]],i=null==s[3]?t:s[3]}else if((0,c.stupidIsType)(e,Object)){var u=e;a=[u.x,u.y,u.z],i=null==u.angle?t:u.angle}else if((0,c.stupidIsType)(e,String)||"string"==typeof e){var m=e;switch(m){case"x":a=[1,0,0];break;case"y":a=[0,1,0];break;case"z":a=[0,0,1];break;default:a=[0,0,0]}i=t}var l=(0,o.angleToRadian)(.5*i),f=Math.sin(l),d=Math.cos(l);return e=a[0]*f,t=a[1]*f,r=a[2]*f,n(e,t,r,d)},length:function(e){return Math.sqrt(this.lengthSquare(e))},lengthSquare:function(e){return e.x*e.x+e.y*e.y+e.z*e.z+e.w*e.w},getNorm:function(e){var t=s.static.length(e);return n(e.x/t,e.y/t,e.z/t,e.w/t)},isNorm:function(e){var t=s.static.lengthSquare(e);return Math.abs(t-1)<1e-4},multiply:function(e,t){var r=(0,o.createVector3)(e.x,e.y,e.z),i=(0,o.createVector3)(t.x,t.y,t.z),a=o.Vector3.static.cross(r,i),c=o.Vector3.static.scale(i,e.w),s=o.Vector3.static.scale(r,t.w),u=(0,o.createVector3)();u.add(a).add(c).add(s);var m=e.w*t.w,l=o.Vector3.static.dot(r,i),f=m-l;return n(u.x,u.y,u.z,f)}},init:function(e,t,r,n){var a=[0,0,0,1];if(null!=e)if((0,c.stupidIsType)(e,Array)){var o=e;a=[].concat(i(o))}else if((0,c.stupidIsType)(e,Object)){var s=e;a=[s.x,s.y,s.z,s.w]}else a=[e,t,r,n];this._={q:a}},get x(){return this._.q[0]},get y(){return this._.q[1]},get z(){return this._.q[2]},get w(){return this._.q[3]},copy:function(){return n(this.x,this.y,this.z,this.w)},isNorm:function(){return s.static.isNorm(this)},normalize:function(){var e=s.static.getNorm(this);return this._.q=e._.q,this},multiply:function(e){return s.static.multiply(this,e)}};t.Quaternion=s,t.createQuaternion=n,t.createQuaternionFromAxisAngle=a},function(e,t,r){"use strict";function i(e){return a*e/180}function n(e){return 180*e/a}Object.defineProperty(t,"__esModule",{value:!0});var a=3.1415926;t.PI=a,t.angleToRadian=i,t.radianToAngle=n},function(e,t,r){"use strict";function i(e){return e?!!a.SceneNode.static.init(e)||(u.default.prod.error("failed to init SceneNode environment"),!1):(u.default.prod.error("no glib parameter given"),!1)}Object.defineProperty(t,"__esModule",{value:!0}),t.SimpleMesh=t.createSimpleMesh=t.SceneNode=t.createSceneNode=t.Camera=t.createCamera=t.Scene=t.createScene=t.initSceneAndNodeEnvironment=void 0;var n=r(22),a=r(9),o=r(4),c=r(3),s=r(0),u=function(e){return e&&e.__esModule?e:{default:e}}(s);t.initSceneAndNodeEnvironment=i,t.createScene=n.createScene,t.Scene=n.Scene,t.createCamera=o.createCamera,t.Camera=o.Camera,t.createSceneNode=a.createSceneNode,t.SceneNode=a.SceneNode,t.createSimpleMesh=c.createSimpleMesh,t.SimpleMesh=c.SimpleMesh},function(e,t,r){"use strict";function i(){var e=Object.create(c);return e.init(),e}Object.defineProperty(t,"__esModule",{value:!0}),t.Scene=t.createScene=void 0;var n=r(9),a=r(3),o=r(4),c={init:function(){Object.assign(this,{rootSceneNode:(0,n.createSceneNode)({name:"sceneRootNode"}),nodes:{simpleMesh:[],camera:[],light:[]},renderOptions:{wireframeMode:!0}})},addSceneNode:function(e){switch(e.mounted.type){case a.SimpleMesh.static.type:this.nodes.simpleMesh.push(e);break;case o.Camera.static.type:this.nodes.camera.push(e)}this.rootSceneNode.addSceneNode(e)},update:function(){this.rootSceneNode.update(this.renderOptions)}};t.createScene=i,t.Scene=c}])});